<html>
<head>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    if (changeInfo.status=='loading') {
        var domain = tab.url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/)[2];
        $.getJSON('http://sopa.active.cx/d/' + domain,function(r) {
            if (r.isGoDaddy) { 
                console.log(domain + ' is registered by GoDaddy(R)');
                chrome.tabs.executeScript(null,{ file: 'godaddy.js' });
            } else if (r.isSOPASupporter) {
                console.log(domain + ' is allegedly a SOPA supporter');
                chrome.tabs.executeScript(null,{ file: 'sopa.js' });
            }
        });
    }

});
</script>
</head>
</html>